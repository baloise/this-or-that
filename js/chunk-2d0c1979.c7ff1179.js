(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0c1979"],{4766:function(e,t,i){"use strict";i.r(t);var s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("section",{attrs:{id:"create"}},[i("Header"),this.surveyCode?e._e():i("section",{staticClass:"container padded-container"},[i("h1",{staticClass:"title is-3"},[e._v("Create A Survey")]),i("b-field",{attrs:{label:"Choose a perspective for your survey!"}},[i("b-input",{attrs:{disabled:e.isLoading,placeholder:"Enter a survey name"},model:{value:e.perspective,callback:function(t){e.perspective=t},expression:"perspective"}})],1),i("label",{staticClass:"label"},[e._v("Upload your Images! (Only PNG & JPG are supported)")]),i("div",{staticClass:"field",staticStyle:{"max-height":"200px"}},[i("b-field",{staticClass:"custom-upload-expanded",attrs:{expanded:!0}},[i("b-upload",{attrs:{accept:"image/x-png,image/png,image/jpeg",multiple:!0,"drag-drop":""},model:{value:e.imageFiles,callback:function(t){e.imageFiles=t},expression:"imageFiles"}},[i("section",{staticClass:"section"},[i("div",{staticClass:"content has-text-centered"},[i("p",[i("b-icon",{attrs:{icon:"upload",size:"is-large"}})],1),i("p",[e._v("Drop your file here or click to upload")])])])])],1)],1),e.images&&e.images.length>0?i("p",{staticClass:"label"},[e._v("Images")]):e._e(),i("div",{staticClass:"columns is-mobile is-multiline"},e._l(e.images,(function(t,s){return i("div",{key:s,staticClass:"column is-half is-one-quarter-desktop"},[i("figure",{staticClass:"image is-square",staticStyle:{position:"relative"}},[i("div",{staticStyle:{position:"absolute","z-index":"100",top:"15px",width:"100%","text-align":"center","font-size":"3em"}},[t.isProcessing?i("font-awesome-icon",{attrs:{size:"lg",icon:"spinner",spin:""}}):e._e()],1),t.isProcessing?e._e():i("button",{staticClass:"delete is-large",staticStyle:{position:"absolute","z-index":"100",top:"5px",right:"5px"},on:{click:function(t){return e.deleteImage(s)}}}),t.source?i("img",{attrs:{src:t.source,alt:"Preview "+(s+1)}}):e._e()])])})),0),i("hr"),i("b-notification",{attrs:{closable:!1,role:"alert",type:"is-warning"}},[e._v(" Please be advised that your survey and all connected data will be deleted automatically after 24 hours. ")]),i("div",{staticClass:"field"},[i("b-checkbox",{model:{value:e.checkBox,callback:function(t){e.checkBox=t},expression:"checkBox"}},[e._v("I agree to the "),i("router-link",{attrs:{to:"/tos"}},[e._v("Terms of Service")]),e._v(" and "),i("router-link",{attrs:{to:"/privacy"}},[e._v("Privacy Policy")]),e._v(" . ")],1)],1),i("div",{staticClass:"buttons"},[i("b-button",{attrs:{type:"is-primary",disabled:!e.isFormValid,loading:e.isLoading,size:"is-medium"},on:{click:function(t){return e.create()}}},[e._v("Create Survey ")]),i("b-button",{attrs:{type:"is-info",disabled:e.isLoading,loading:e.isLoading,size:"is-medium"},on:{click:function(t){return e.back()}}},[e._v("Cancel ")])],1)],1),this.surveyCode&&!this.isLoading?i("section",{staticClass:"hero is-info is-fullheight-with-navbar"},[i("div",{staticClass:"hero-body",staticStyle:{"flex-direction":"column"}},[i("h3",{staticClass:"title is-2"},[e._v("Your Survey is ready!")]),i("br"),i("h3",{staticClass:"subtitle is-3"},[e._v("SurveyCode = "+e._s(this.surveyCode))]),i("br"),i("div",{staticClass:"box",staticStyle:{display:"inline-block"}},[i("qrcode-vue",{attrs:{value:this.qrCodeUrl,size:"200",level:"H"}})],1),i("br"),i("div",{staticClass:"field is-grouped is-grouped-centered"},[i("div",{staticClass:"buttons"},[i("b-button",{attrs:{type:"is-primary",size:"is-medium"},on:{click:function(t){return e.vote()}}},[e._v(" Let's Vote ")])],1)])])]):e._e(),i("b-loading",{attrs:{active:e.isLoading,"is-full-page":!0},on:{"update:active":function(t){e.isLoading=t}}}),i("Footer")],1)},a=[],r=i("9ab4"),n=i("60a3"),o=i("c3df"),c=i("d7b0"),l=i("7296"),u=i("fcf8"),d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.perspective="",t.surveyCode="",t.qrCodeUrl="",t.isLoading=!1,t.checkBox=!1,t.imageFiles=null,t.images=[],t}return Object(r["d"])(t,e),Object.defineProperty(t.prototype,"isFormValid",{get:function(){return!!this.perspective&&this.images.filter((function(e){return!e.isProcessing})).length>2&&this.checkBox},enumerable:!1,configurable:!0}),t.prototype.fileInput=function(){var e=this;if(this.imageFiles){var t=this.imageFiles.map((function(e){return{originalFile:e,isProcessing:!0}}));this.imageFiles=null,this.images=this.images.concat(t).map((function(e,t){return Object(r["a"])(Object(r["a"])({},e),{index:t})})),setTimeout((function(){e.processNextImage()}),100)}},t.prototype.create=function(){return Object(r["b"])(this,void 0,void 0,(function(){var e,t,i,s=this;return Object(r["e"])(this,(function(a){switch(a.label){case 0:this.isLoading=!0,e={perspective:this.perspective},a.label=1;case 1:return a.trys.push([1,,5,6]),[4,Object(o["b"])(e)];case 2:return t=a.sent(),this.surveyCode=t.code,i=window.location.href,this.qrCodeUrl=i.split("#")[0]+"#/"+this.surveyCode+"/vote",[4,Promise.all(this.images.map((function(e){return Object(r["b"])(s,void 0,void 0,(function(){var i;return Object(r["e"])(this,(function(s){switch(s.label){case 0:return i={file:e.source},[4,Object(o["a"])(i,t.code)];case 1:return s.sent(),[2]}}))}))})))];case 3:return a.sent(),[4,Object(o["g"])(t.code)];case 4:return a.sent(),[3,6];case 5:return this.isLoading=!1,[7];case 6:return[2]}}))}))},t.prototype.deleteImage=function(e){this.images.splice(e,1)},t.prototype.back=function(){this.$router.push("/")},t.prototype.vote=function(){this.$router.push(this.surveyCode+"/vote")},t.prototype.processNextImage=function(){return Object(r["b"])(this,void 0,void 0,(function(){var e,t,i,s,a,n=this;return Object(r["e"])(this,(function(o){switch(o.label){case 0:return e=this.images.filter((function(e){return e.isProcessing})),e.length>0?(t=e[0],i=t,[4,this.readImage(t.originalFile)]):[3,4];case 1:return i.source=o.sent(),[4,this.createImage(t.source)];case 2:return s=o.sent(),a=t,[4,this.resizeImage(s)];case 3:a.source=o.sent(),this.images[t.index]=Object(r["a"])(Object(r["a"])({},t),{isProcessing:!1}),this.images=Object(r["f"])(this.images),setTimeout((function(){n.processNextImage()}),100),o.label=4;case 4:return[2]}}))}))},t.prototype.readImage=function(e){return new Promise((function(t,i){if("function"===typeof FileReader){var s=new FileReader;s.onload=function(e){e&&e.target&&t(e.target.result)},s.readAsDataURL(e)}else alert("Sorry, FileReader API not supported"),i()}))},t.prototype.resizeImage=function(e){return Object(r["b"])(this,void 0,void 0,(function(){var t,i,s,a,n,o,c,l,u;return Object(r["e"])(this,(function(r){return t=document.createElement("canvas"),i=480,s=480,t.width=i,t.height=s,a=t.getContext("2d"),a&&(n=0,o=0,c=void 0,l=void 0,u=e.height/e.width,e.height<e.width?(u=e.width/e.height,l=s,c=u*s,n=-(c-i)/2):(c=i,l=u*i,o=-(l-s)/2),a.fillStyle="#FFFFFF",a.fillRect(0,0,480,480),a.drawImage(e,n,o,c,l)),[2,t.toDataURL("image/jpeg",1)]}))}))},t.prototype.createImage=function(e){return new Promise((function(t,i){var s=new Image;s.onload=function(){t(s)},s.src=e}))},Object(r["c"])([Object(n["e"])("imageFiles")],t.prototype,"fileInput",null),t=Object(r["c"])([Object(n["a"])({components:{Footer:u["a"],Header:l["a"],QrcodeVue:c["a"]}})],t),t}(n["d"]),p=d,h=p,g=i("2877"),v=Object(g["a"])(h,s,a,!1,null,null,null);t["default"]=v.exports}}]);
//# sourceMappingURL=chunk-2d0c1979.c7ff1179.js.map